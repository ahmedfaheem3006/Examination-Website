<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ExamPrep - Exam</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          colors: {
            primary: '#5c6bc0',
            secondary: '#2da0a8',
          },
          fontFamily: {
            poppins: ['Poppins', 'sans-serif'],
          },
        },
      },
    }
  </script>
  <style>
    * { font-family: 'Poppins', sans-serif; }

    /* ===== SCROLLBAR ===== */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #c4c4c4; border-radius: 10px; }
    .dark ::-webkit-scrollbar-thumb { background: #555; }

    /* ===== ENTRANCE ANIMATIONS ===== */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInLeft {
      from { opacity: 0; transform: translateX(-30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes fadeInRight {
      from { opacity: 0; transform: translateX(30px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-30px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.85); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes slideInOption {
      from { opacity: 0; transform: translateX(-20px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes pulseGlow {
      0%, 100% { box-shadow: 0 0 0 0 rgba(92, 107, 192, 0.3); }
      50% { box-shadow: 0 0 20px 5px rgba(92, 107, 192, 0.15); }
    }
    @keyframes floatIn {
      0% { opacity: 0; transform: translateY(20px) scale(0.9); }
      60% { transform: translateY(-5px) scale(1.02); }
      100% { opacity: 1; transform: translateY(0) scale(1); }
    }
    @keyframes loadSpin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    @keyframes loadPulse {
      0%, 100% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.1); opacity: 0.7; }
    }
    @keyframes twinkle {
      0% { opacity: 0.3; transform: scale(0.8); }
      100% { opacity: 1; transform: scale(1.2); }
    }

    .anim-header {
      animation: fadeInDown 0.6s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
    .anim-question-card {
      animation: fadeInLeft 0.7s cubic-bezier(0.22, 1, 0.36, 1) 0.15s both;
    }
    .anim-sidebar {
      animation: fadeInRight 0.7s cubic-bezier(0.22, 1, 0.36, 1) 0.25s both;
    }
    .anim-option {
      animation: slideInOption 0.4s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
    .anim-question-text {
      animation: fadeInUp 0.5s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
    .anim-grid-btn {
      animation: scaleIn 0.3s cubic-bezier(0.22, 1, 0.36, 1) both;
    }
    .pulse-glow {
      animation: pulseGlow 2s infinite;
    }
    .question-enter {
      animation: fadeInUp 0.4s cubic-bezier(0.22, 1, 0.36, 1) both;
    }

    /* ===== LOADING OVERLAY ===== */
    .loading-overlay {
      position: fixed;
      inset: 0;
      z-index: 100;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      background: linear-gradient(135deg, #e8eaf6 0%, #e0f2f1 100%);
      transition: opacity 0.6s ease, visibility 0.6s ease;
    }
    .dark .loading-overlay {
      background: linear-gradient(135deg, #1e1e2e 0%, #0f172a 100%);
    }
    .loading-overlay.hide {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
    }
    .load-spinner {
      width: 48px;
      height: 48px;
      border: 4px solid rgba(92, 107, 192, 0.2);
      border-top-color: #5c6bc0;
      border-radius: 50%;
      animation: loadSpin 0.8s linear infinite;
    }
    .load-text {
      animation: loadPulse 1.5s ease-in-out infinite;
    }

    /* ===== THEME TOGGLE ===== */
    .theme-toggle {
      position: relative;
      width: 56px;
      height: 28px;
      border-radius: 50px;
      border: none;
      cursor: pointer;
      overflow: hidden;
      transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
      background: linear-gradient(135deg, #87CEEB, #4FC3F7);
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      flex-shrink: 0;
    }
    .dark .theme-toggle {
      background: linear-gradient(135deg, #1a1a3e, #2d1b69);
    }
    .theme-toggle-bg {
      position: absolute;
      inset: 0;
      transition: all 0.5s ease;
    }
    .theme-toggle-thumb {
      position: absolute;
      top: 3px;
      left: 3px;
      width: 22px;
      height: 22px;
      border-radius: 50%;
      background: linear-gradient(135deg, #FFD700, #FFA500);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      z-index: 2;
    }
    .dark .theme-toggle-thumb {
      left: 31px;
      background: linear-gradient(135deg, #C0C0C0, #E8E8E8);
    }
    .theme-toggle .sun-icon {
      font-size: 11px;
      color: #fff;
      transition: all 0.4s ease;
    }
    .dark .theme-toggle .sun-icon {
      opacity: 0;
      transform: rotate(180deg) scale(0);
    }
    .theme-toggle .moon-icon {
      font-size: 10px;
      color: #2d1b69;
      position: absolute;
      opacity: 0;
      transform: rotate(-180deg) scale(0);
      transition: all 0.4s ease;
    }
    .dark .theme-toggle .moon-icon {
      opacity: 1;
      transform: rotate(0deg) scale(1);
    }
    .star {
      position: absolute;
      width: 3px;
      height: 3px;
      background: #fff;
      border-radius: 50%;
      opacity: 0;
      transition: all 0.5s ease;
      animation: twinkle 1.5s infinite alternate;
    }
    .dark .star { opacity: 1; }
    .cloud {
      position: absolute;
      width: 12px;
      height: 6px;
      background: rgba(255, 255, 255, 0.8);
      border-radius: 10px;
      transition: all 0.5s ease;
    }
    .dark .cloud { opacity: 0; transform: translateX(10px); }

    /* ===== DARK MODE OVERRIDES ===== */
    .dark body { background: #0f172a; color: #e2e8f0; }
    .dark .bg-white { background: #1e293b !important; }
    .dark .bg-slate-50, .dark .bg-slate-100 { background: #334155 !important; }
    .dark .bg-gray-100 { background: #374151 !important; }
    .dark .text-slate-800 { color: #f1f5f9 !important; }
    .dark .text-slate-500 { color: #94a3b8 !important; }
    .dark .text-slate-600 { color: #94a3b8 !important; }
    .dark .text-gray-400 { color: #6b7280 !important; }
    .dark .text-gray-500 { color: #9ca3af !important; }
    .dark .text-gray-600 { color: #d1d5db !important; }
    .dark .text-gray-800 { color: #f3f4f6 !important; }
    .dark .border-slate-50 { border-color: #334155 !important; }
    .dark .border-slate-100 { border-color: #475569 !important; }
    .dark .shadow-lg { box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3) !important; }
    .dark .bg-green-50 { background: rgba(34, 197, 94, 0.1) !important; }
    .dark .bg-red-50 { background: rgba(239, 68, 68, 0.1) !important; }
    .dark .bg-gray-50 { background: rgba(107, 114, 128, 0.1) !important; }
    .dark .bg-orange-50 { background: rgba(251, 146, 60, 0.1) !important; }
    .dark #optionsContainer button {
      background: #1e293b;
      border-color: #334155;
    }
    .dark #optionsContainer button:hover {
      background: #263348;
      border-color: rgba(92, 107, 192, 0.3);
    }
    .dark #optionsContainer button.selected-option {
      background: rgba(92, 107, 192, 0.08);
      border-color: #5c6bc0;
    }
    .dark .bg-f8fafc { background: #0f172a !important; }
  </style>
</head>

<body class="bg-[#f8fafc] text-slate-900 min-h-screen flex flex-col p-3 md:p-4 lg:p-5 overflow-auto">

  <!-- ========== LOADING OVERLAY ========== -->
  <div class="loading-overlay" id="loadingOverlay">
    <div class="relative z-10 flex flex-col items-center gap-4">
      <div class="load-spinner"></div>
      <div class="load-text">
        <p class="text-lg font-bold text-primary">Preparing your exam...</p>
      </div>
    </div>
  </div>

  <!-- ========== HEADER ========== -->
  <header class="anim-header w-full max-w-7xl mx-auto bg-white dark:bg-slate-800 rounded-xl shadow-lg px-4 py-3 mb-3 shrink-0">
    <div class="flex items-center justify-between">

      <div class="flex items-center gap-3">
        <div>
          <h1 class="text-base md:text-lg font-bold text-slate-800 leading-tight" id="examTitle">Exam</h1>
          <p class="text-xs text-slate-500" id="questionCounter">Question 1 of 10</p>
        </div>
      </div>

      <div class="flex items-center gap-2 sm:gap-3">
        <button onclick="toggleTheme()" class="theme-toggle" title="Toggle Dark Mode">
          <div class="theme-toggle-bg">
            <div class="star" style="top:5px; left:35px;"></div>
            <div class="star" style="top:12px; left:42px; animation-delay:0.3s;"></div>
            <div class="star" style="top:20px; left:38px; animation-delay:0.7s;"></div>
            <div class="star" style="top:8px; left:48px; animation-delay:1s;"></div>
            <div class="cloud" style="top:8px; left:30px;"></div>
            <div class="cloud" style="top:16px; left:36px; width:8px;"></div>
          </div>
          <div class="theme-toggle-thumb">
            <i class="fa-solid fa-sun sun-icon"></i>
            <i class="fa-solid fa-moon moon-icon"></i>
          </div>
        </button>

        <div class="flex items-center gap-1.5" id="timerContainer">
          <i class="fa-regular fa-clock text-primary text-sm"></i>
          <span class="text-sm md:text-base font-bold font-mono text-slate-800" id="timer">30:00</span>
        </div>
        <div class="hidden sm:block bg-slate-100 px-2.5 py-1 rounded-lg text-xs font-medium text-slate-500" id="answeredCount">0/10</div>
      </div>
    </div>

    <!-- Progress Bar -->
    <div class="w-full h-1.5 bg-slate-100 rounded-full mt-2 overflow-hidden">
      <div class="h-full bg-gradient-to-r from-primary to-secondary rounded-full transition-all duration-500" id="progressBar" style="width:10%"></div>
    </div>
  </header>

  <!-- ========== MAIN ========== -->
  <main class="w-full max-w-7xl mx-auto flex-1 flex flex-col lg:flex-row gap-3 min-h-0">

    <!-- ===== QUESTION CARD ===== -->
    <section class="anim-question-card flex-1 bg-white dark:bg-slate-800 rounded-xl shadow-lg flex flex-col min-h-0 transition-all duration-500" id="questionCard">

      <!-- Question Header -->
      <div class="flex items-center justify-between px-4 py-2.5 border-b border-slate-50 shrink-0">
        <h2 class="text-sm font-bold text-slate-800" id="questionTitle">Question 1</h2>
        <button
          class="flex items-center gap-1.5 px-3 py-1.5 rounded-lg border-2 border-slate-100 text-slate-500 text-xs font-medium hover:border-orange-400 hover:text-orange-500 hover:bg-orange-50 hover:shadow-sm transition-all duration-300"
          id="flagBtn"
          onclick="toggleFlag()">
          <i class="fa-regular fa-flag text-xs"></i>
          <span id="flagText">Flag</span>
        </button>
      </div>

      <!-- Question Body -->
      <div class="flex-1 flex flex-col justify-center px-4 py-3 min-h-0 overflow-y-auto">
        <p class="text-sm md:text-lg font-medium text-slate-800 mb-6" id="questionText">Loading question...</p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-2" id="optionsContainer"></div>
      </div>

      <!-- Navigation -->
      <div class="flex items-center justify-between px-4 py-3 border-t border-slate-50 shrink-0">
        <button
          class="flex items-center gap-1.5 px-4 py-2 rounded-lg text-xs font-semibold text-slate-500 border-2 border-slate-100 hover:border-primary hover:text-primary transition-all duration-300 disabled:opacity-30 disabled:cursor-not-allowed disabled:hover:border-slate-100 disabled:hover:text-slate-500"
          id="prevBtn"
          onclick="goToPrevious()"
          disabled>
          <i class="fa-solid fa-chevron-left text-[10px]"></i> Previous
        </button>
        <button
          class="flex items-center gap-1.5 px-6 py-2.5 rounded-lg text-xs font-semibold text-white bg-gradient-to-r from-primary to-secondary shadow-lg shadow-primary/20 hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 pulse-glow"
          id="nextBtn"
          onclick="goToNext()">
          <span id="nextBtnText">Next</span>
          <i class="fa-solid fa-chevron-right text-[10px]" id="nextBtnIcon"></i>
        </button>
      </div>
    </section>

    <!-- ===== SIDEBAR ===== -->
    <aside class="anim-sidebar w-full lg:w-56 xl:w-64 shrink-0 flex flex-col sm:flex-row lg:flex-col gap-3 min-h-0">

      <!-- Question Grid -->
      <div class="flex-1 bg-white dark:bg-slate-800 rounded-xl shadow-lg p-4 flex flex-col min-h-0">
        <h3 class="text-xs font-bold text-slate-800 mb-3 shrink-0">Questions Navigation</h3>
        <div class="grid grid-cols-5 gap-1.5 mb-3 overflow-y-auto" id="questionGrid"></div>

        <!-- Legend -->
        <div class="grid grid-cols-2 gap-x-3 gap-y-1 shrink-0 mt-auto pt-2">
          <div class="flex items-center gap-1.5">
            <div class="w-2.5 h-2.5 rounded-sm bg-gradient-to-r from-primary to-secondary"></div>
            <span class="text-[10px] text-gray-400">Current</span>
          </div>
          <div class="flex items-center gap-1.5">
            <div class="w-2.5 h-2.5 rounded-sm bg-green-500"></div>
            <span class="text-[10px] text-gray-400">Answered</span>
          </div>
          <div class="flex items-center gap-1.5">
            <div class="w-2.5 h-2.5 rounded-sm bg-orange-400"></div>
            <span class="text-[10px] text-gray-400">Flagged</span>
          </div>
          <div class="flex items-center gap-1.5">
            <div class="w-2.5 h-2.5 rounded-sm bg-gray-600"></div>
            <span class="text-[10px] text-gray-500">Unanswered</span>
          </div>
        </div>
      </div>

      <!-- Submit -->
      <button
        class="lg:shrink-0 flex items-center justify-center gap-2 px-4 py-2.5 lg:py-3 rounded-xl text-xs font-bold text-white bg-gradient-to-r from-primary to-secondary shadow-md shadow-primary/20 hover:shadow-lg hover:-translate-y-0.5 transition-all duration-300"
        onclick="submitExam()">
        <i class="fa-solid fa-paper-plane text-[10px]"></i> Submit Exam
      </button>
    </aside>
  </main>

  <!-- ========== CONFIRM MODAL ========== -->
  <div class="fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-50 flex items-center justify-center p-4 opacity-0 invisible transition-all duration-300" id="confirmModal">
    <div class="bg-white dark:bg-slate-800 rounded-2xl p-8 w-full max-w-sm shadow-2xl text-center transition-transform duration-300 scale-90">
      <div class="w-14 h-14 mx-auto bg-orange-50 rounded-full flex items-center justify-center mb-4">
        <i class="fa-solid fa-triangle-exclamation text-2xl text-orange-500"></i>
      </div>
      <h3 class="text-lg font-bold text-slate-800 mb-2">Submit Exam?</h3>
      <p class="text-xs text-slate-500 mb-4">Are you sure you want to submit?</p>
      <div class="text-xs bg-slate-50 dark:bg-slate-700 rounded-xl p-4 mb-6 space-y-2 text-left text-slate-600" id="submitSummary"></div>
      <div class="flex gap-3">
        <button onclick="closeModal('confirmModal')" class="flex-1 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 font-semibold text-xs py-3 rounded-xl hover:bg-slate-200 dark:hover:bg-slate-600 transition-all">Cancel</button>
        <button onclick="confirmSubmit()" class="flex-1 bg-gradient-to-r from-primary to-secondary text-white font-semibold text-xs py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all">Yes, Submit</button>
      </div>
    </div>
  </div>

  <!-- ========== TIME UP MODAL ========== -->
  <div class="fixed inset-0 bg-slate-900/40 backdrop-blur-sm z-50 flex items-center justify-center p-4 opacity-0 invisible transition-all duration-300" id="timeUpModal">
    <div class="bg-white dark:bg-slate-800 rounded-2xl p-8 w-full max-w-sm shadow-2xl text-center transition-transform duration-300 scale-90">
      <div class="w-14 h-14 mx-auto bg-red-50 rounded-full flex items-center justify-center mb-4">
        <i class="fa-solid fa-clock text-2xl text-red-500"></i>
      </div>
      <h3 class="text-lg font-bold text-slate-800 mb-2">Time's Up!</h3>
      <p class="text-xs text-slate-500 mb-6">Your exam has been auto-submitted.</p>
      <button onclick="showResults()" class="w-full bg-gradient-to-r from-primary to-secondary text-white font-semibold text-xs py-3 rounded-xl shadow-lg hover:shadow-2xl transition-all">View Results</button>
    </div>
  </div>

  <!-- ========== RESULTS MODAL ========== -->
  <div class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4 opacity-0 invisible transition-all duration-300" id="resultsModal">
    <div class="bg-white dark:bg-slate-800 rounded-2xl p-5 w-full max-w-lg shadow-2xl transition-transform duration-300 scale-90 max-h-[92vh] overflow-y-auto">
      <div class="text-center mb-5">
        <div class="w-20 h-20 mx-auto rounded-full flex items-center justify-center mb-3" id="scoreCircle">
          <span class="text-2xl font-bold text-white" id="scoreText">0%</span>
        </div>
        <h3 class="text-xl font-bold text-gray-800" id="resultTitle">Your Result</h3>
        <p class="text-xs text-gray-500" id="resultSubtitle"></p>
      </div>
      <div class="grid grid-cols-3 gap-2 mb-5">
        <div class="bg-green-50 rounded-xl p-3 text-center">
          <p class="text-lg font-bold text-green-600" id="correctCount">0</p>
          <p class="text-[10px] text-green-500">Correct</p>
        </div>
        <div class="bg-red-50 rounded-xl p-3 text-center">
          <p class="text-lg font-bold text-red-600" id="wrongCount">0</p>
          <p class="text-[10px] text-red-500">Wrong</p>
        </div>
        <div class="bg-gray-50 rounded-xl p-3 text-center">
          <p class="text-lg font-bold text-gray-600" id="skippedCount">0</p>
          <p class="text-[10px] text-gray-400">Skipped</p>
        </div>
      </div>
      <h4 class="text-sm font-bold text-gray-800 mb-3">Review Answers</h4>
      <div class="space-y-2" id="reviewContainer"></div>
      <div class="flex gap-3 mt-5">
        <a href="ExamSelect.html" class="flex-1 flex items-center justify-center gap-1.5 bg-gray-100 dark:bg-slate-700 text-gray-600 dark:text-gray-300 font-semibold text-xs py-2.5 rounded-xl hover:bg-gray-200 dark:hover:bg-slate-600 transition-all no-underline">
          <i class="fa-solid fa-house text-[10px]"></i> Home
        </a>
        <button onclick="retakeExam()" class="flex-1 flex items-center justify-center gap-1.5 bg-gradient-to-r from-primary to-secondary text-white font-semibold text-xs py-2.5 rounded-xl shadow-md hover:shadow-lg transition-all">
          <i class="fa-solid fa-rotate text-[10px]"></i> Retake
        </button>
      </div>
    </div>
  </div>

  <script src="Exam.js"></script>
</body>
</html>